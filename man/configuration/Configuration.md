# Конфигурация

В этом документе описывается конфигурация в том виде, с которым работает конкетный сервер. 
Сервер должен иметь локально доступ ко всем зависимостям. 

Общее описание конфигурации содержится в [этом документе](https://github.com/A7Systems/A7JSScripts/blob/main/Configuraiton.md). Установщик(шедуллер), скачав такую конфигурацию, должен разрешить все зависимости, скачать необходимые пакеты, и настроить все окружение сервера. 
А сервер получает конечное описание конфигурации, которое содержится в этом документе.

Оно содержится в файле configuration.yaml.

В нем необходимо описать:

## Название и версия конфигурации

```YAML
name: TestClever
version: 1.0.0
```

## Список пакетов

Описывается список входящих в конфигурации пакетов, классов с указанием версий, и пути к исходникам.


```YAML
packets:
  CleverBase:
    CleverMarketItem:
        path: ./configuration/CleverBase/CleverMarketItem.js
        version: 1.0.0
    CleverBaseRT:
        path: ./configuration/CleverBase/CleverBaseRT.js
        version: 1.0.0
```

Если указана MD5 хэш-сумма файла, она будет проверяться при загрузке плагина сервером

## Ссылка на базовую конфигурацию

Указывается конфигурация, от которой наследуется текущая конфигурация

```YAML
baseConfiguration: BaseConfigName 1.0.0

```


## Зависимости

Здесь описываются ссылки на внешние пакеты, их версии, которые не входят в данную конфигурации. К этим пакетам можно будет обращаться из кода в данной конфигурации

```YAML
dependencies: 
    BasePacket:
    BasePacketType:
        path: ./ExPackets/BasePacketType.js
        version: 1.0.0

```

## Аддоны

Дополнительные модули, файлы которые используются для работы с данной конфигурацией. Которые не относятся к коду или плагинам

```YAML
addons: 
    reportTemplate1:
        path: ./reports/template1.xlsx


```


## Настройка системы прав

Система прав, которая может быть использована для space-ов для этой конфигурации. 

```YAML
rights:
  simple:
    path: ./defplugins/rightsPlugin.so
```

## Настройка системы логирования по умолчанию.

Настройка состоит из следующих блоков:
- `consoleLog` - настройка вывода логов в **stdout**
  - `enabled` - **`[on/off]`** вывод включен или выключен.
- `fileLog` - настройка вывода логов в файл.
  - `enabled` - **[on/off]** вывод включен или выключен.
  - `path` - путь, по которому будут записаны логи

- tcpLog - настойки удаленного лог-сервера
  - `enabled` - **[on/off]** вывод включен или выключен.
  - `host` - адрес удаленного лог-сервера
  - `port` - порт удаленного лог-сервера
- `scriptLog` - настройки вывода логов из скриптовой части сервера (например `console.log('message');`)

К каждому типу логов может быть настроен список фильтрации:
  - `filter` - список фильтрации сообщений разделенный пробелами, попадающих в лог
    - `debug` - отладочные сообщения
    - `info` - информационные сообщения
    - `warning` - предупреждения
    - `critical` - сообщения о критических ошибках

```YAML
logs:
  consoleLog:
    enabled: off
  fileLog:
    enabled: on
    path: ./Logs/
    filter: -debug -info
  tcpLog:
    enabled: off
    host: 127.0.0.1
    port: 10255
  scriptLog:
    enabled: on
```


## Типы для корневых и специальных объектов 


`spaceApp` - корневой объект для space-а

`userData` - объект создается для каждого пользователя, для хранения настроек данного пользователя 

```YAML
spaceApp: CleverHomeSpace
userData: CleverHomeUserdata
```